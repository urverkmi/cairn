<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cairn</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f4f8;
            text-align: center;
        }
        .meditation-container {
            text-align: center;
            max-width: 600px;
            padding: 20px;
        }
        #breathing-ellipse {
            position: relative;
            width: 200px;
            height: 100px;
            background-color: beige;
            border-radius: 50%;
            margin: 0 auto 30px;
            overflow: hidden;
            transition: transform 2s ease-in-out;
        }
        #texture-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('textures/stone.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            opacity: 0.3; /* Adjust opacity as needed */
            mix-blend-mode: normal; /* Experiment with different blend modes */
        }
        .prompt {
            font-size: 16px;
            margin-top: 50px;
            margin-bottom: 60px;
            color: #333;
        }
        .timer {
            font-size: 18px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="meditation-container">
        <div id="breathing-ellipse">
            <div id="texture-overlay"></div>
        </div>
        <div id="prompt" class="prompt"></div>
        <!-- <div id="timer" class="timer"></div> -->
    </div>

    <script>
        // Meditation prompts mapped to emotions
        const meditationPrompts = {
            'anxious': [
                { text: 'Breathe deeply. \r\nFeel gravity holding you.', duration: 2 },
                { text: 'Your worries are valid. \r\nFocus on the present.', duration: 2 },
                { text: 'You are safe right now.', duration: 2 }
            ],
            'overwhelmed': [
                { text: 'Pause, and notice your breathing.', duration: 45 },
                { text: 'Notice how you are feeling, without judgement.', duration: 60 },
                { text: 'xxx', duration: 45 }
            ],
            'frustrated': [
                { text: 'xxx', duration: 45 },
                { text: 'xxx', duration: 60 },
                { text: 'xxx', duration: 45 }
            ],
            'peaceful': [
                { text: 'Savor the calm.', duration: 45 },
                { text: 'xxx', duration: 60 },
                { text: 'xxx', duration: 45 }
            ],
            'bored': [
                { text: 'Look at your surroudings. \r\nNotice the details.', duration: 45 },
                { text: 'xxx', duration: 60 },
                { text: 'xxx', duration: 45 }
            ],
            'agitated': [
            { text: 'Slow down your breathing.', duration: 45 },
                { text: 'Release the tension in your muscles.', duration: 60 },
                { text: 'Observe the irritations and approach them with curiosity.', duration: 45 }
            ]
        };

        // Get emotion from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const emotion = urlParams.get('emotion') || 'anxiety';
        const prompts = meditationPrompts[emotion.toLowerCase()];

        const promptElement = document.getElementById('prompt');
        promptElement.setAttribute('style', 'white-space: pre;');
        const timerElement = document.getElementById('timer');
        const breathingEllipse = document.getElementById('breathing-ellipse');

        async function startMeditation() {
            for (let prompt of prompts) {
                // Display prompt
                promptElement.textContent = prompt.text;
                
                // Animate breathing ellipse
                breathingEllipse.style.transform = 'scale(1.5)';
                await new Promise(resolve => setTimeout(resolve, 2000));
                breathingEllipse.style.transform = 'scale(1)';

                // Countdown timer
                for (let seconds = prompt.duration; seconds > 0; seconds--) {
                    timerElement.textContent = `Time remaining: ${seconds} seconds`;
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }

            // End of meditation
            promptElement.textContent = 'Meditation complete';
            timerElement.textContent = 'Thank you for taking time for yourself';
        }

        // Start meditation when page loads
        startMeditation();
    </script>
</body>
</html>