<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #p5Canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 0;
        }
        .interactive-area {
            width: 100vw;
            height: 100vh;
            position: relative;
            z-index: 1;
        }
        .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple 0.6s linear;
            background: rgba(0, 0, 0, 0.2);
            pointer-events: none;
        }
        .particle {
            position: absolute;
            pointer-events: none;
            animation: particle 1s ease-out;
        }
        .trail {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            animation: fade 1s ease-out;
        }
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        @keyframes particle {
            to {
                transform: translate(var(--tx), var(--ty));
                opacity: 0;
            }
        }
        @keyframes fade {
            to {
                opacity: 0;
            }
        }
        .pulse {
            position: absolute;
            border-radius: 50%;
            animation: pulse 0.5s ease-out;
            pointer-events: none;
        }
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div id="p5Canvas"></div>
    <div class="interactive-area" id="interactiveArea">
        <div id="stats"></div>
    </div>

    <script>
        let particles = [];
        let curves = [];
        let lastInteractionPoint = null;

        class Particle {
            constructor(x, y) {
                this.pos = createVector(x, y);
                this.vel = createVector(random(-1, 1), random(-1, 1));
                this.acc = createVector(0, 0);
                this.size = random(3, 8);
                this.color = color(random(200, 255), random(200, 255), 255, 100);
                this.maxSpeed = 2;
            }

            update() {
                if (lastInteractionPoint) {
                    let force = p5.Vector.sub(lastInteractionPoint, this.pos);
                    let d = force.mag();
                    if (d < 100) {
                        force.setMag(0.5);
                        this.acc.add(force);
                    }
                }

                this.vel.add(this.acc);
                this.vel.limit(this.maxSpeed);
                this.pos.add(this.vel);
                this.acc.mult(0);

                // Wrap around edges
                if (this.pos.x < 0) this.pos.x = width;
                if (this.pos.x > width) this.pos.x = 0;
                if (this.pos.y < 0) this.pos.y = height;
                if (this.pos.y > height) this.pos.y = 0;
            }

            draw() {
                noStroke();
                fill(this.color);
                circle(this.pos.x, this.pos.y, this.size);
            }
        }

        class Curve {
            constructor() {
                this.points = [];
                this.noiseOffset = random(1000);
                this.color = color(random(200, 255), random(200, 255), 255, 50);
                this.yStart = random(height);
                this.amplitude = random(30, 80);
                this.speed = random(0.001, 0.003);
            }

            update() {
                this.points = [];
                for (let x = 0; x < width; x += 20) {
                    let y = this.yStart + 
                        sin(x * 0.01 + frameCount * this.speed) * this.amplitude +
                        noise(x * 0.01, this.noiseOffset + frameCount * 0.01) * this.amplitude;
                    this.points.push(createVector(x, y));
                }

                if (lastInteractionPoint) {
                    for (let point of this.points) {
                        let d = dist(point.x, point.y, lastInteractionPoint.x, lastInteractionPoint.y);
                        if (d < 100) {
                            point.y += map(d, 0, 100, 20, 0);
                        }
                    }
                }
            }

            draw() {
                noFill();
                stroke(this.color);
                strokeWeight(2);
                beginShape();
                for (let point of this.points) {
                    curveVertex(point.x, point.y);
                }
                endShape();
            }
        }

        function setup() {
            let canvas = createCanvas(windowWidth, windowHeight);
            canvas.parent('p5Canvas');

            // Initialize particles
            for (let i = 0; i < 50; i++) {
                particles.push(new Particle(random(width), random(height)));
            }

            // Initialize curves
            for (let i = 0; i < 5; i++) {
                curves.push(new Curve());
            }
        }

        function draw() {
            clear();
            
            // Update and draw curves
            for (let curve of curves) {
                curve.update();
                curve.draw();
            }

            // Update and draw particles
            for (let particle of particles) {
                particle.update();
                particle.draw();
            }

            // Fade out last interaction point
            if (lastInteractionPoint) {
                lastInteractionPoint.z -= 0.1; // Use z as fade timer
                if (lastInteractionPoint.z <= 0) {
                    lastInteractionPoint = null;
                }
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        class VisualEffects {
            constructor() {
                this.area = document.getElementById('interactiveArea');
                this.stats = document.getElementById('stats');
                this.interactions = {
                    clicks: 0,
                    moves: 0,
                    drags: 0
                };
                this.isDragging = false;
                this.lastMoveTime = Date.now();
                this.moveThrottle = 50;

                this.setupEventListeners();
            }

            setupEventListeners() {
                this.area.addEventListener('click', (e) => this.handleClick(e));
                this.area.addEventListener('mousemove', (e) => this.handleMove(e));
                this.area.addEventListener('mousedown', () => this.isDragging = true);
                this.area.addEventListener('mouseup', () => this.isDragging = false);
                this.area.addEventListener('mouseleave', () => this.isDragging = false);
            }

            createRipple(x, y) {
                const ripple = document.createElement('div');
                ripple.className = 'ripple';
                ripple.style.left = `${x - 25}px`;
                ripple.style.top = `${y - 25}px`;
                ripple.style.width = '50px';
                ripple.style.height = '50px';
                this.area.appendChild(ripple);
                ripple.addEventListener('animationend', () => ripple.remove());
            }

            createParticles(x, y) {
                const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEEAD'];
                for (let i = 0; i < 8; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = `${x}px`;
                    particle.style.top = `${y}px`;
                    particle.style.width = '8px';
                    particle.style.height = '8px';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    
                    const angle = (Math.PI * 2 * i) / 8;
                    const distance = 50 + Math.random() * 50;
                    const tx = Math.cos(angle) * distance;
                    const ty = Math.sin(angle) * distance;
                    
                    particle.style.setProperty('--tx', `${tx}px`);
                    particle.style.setProperty('--ty', `${ty}px`);
                    
                    this.area.appendChild(particle);
                    particle.addEventListener('animationend', () => particle.remove());
                }

                // Update p5.js interaction point
                lastInteractionPoint = createVector(x, y, 1);
            }

            createTrail(x, y) {
                const trail = document.createElement('div');
                trail.className = 'trail';
                trail.style.left = `${x - 5}px`;
                trail.style.top = `${y - 5}px`;
                trail.style.background = `hsl(${Math.random() * 360}, 70%, 50%)`;
                this.area.appendChild(trail);
                trail.addEventListener('animationend', () => trail.remove());

                // Update p5.js interaction point with less intensity
                lastInteractionPoint = createVector(x, y, 0.5);
            }

            handleClick(e) {
                this.interactions.clicks++;
                const effects = [
                    () => this.createRipple(e.clientX, e.clientY),
                    () => this.createParticles(e.clientX, e.clientY)
                ];
                effects[Math.floor(Math.random() * effects.length)]();
                this.updateStats();
            }

            handleMove(e) {
                const now = Date.now();
                if (now - this.lastMoveTime < this.moveThrottle) return;
                
                this.lastMoveTime = now;
                this.interactions.moves++;
                
                if (this.isDragging) {
                    this.interactions.drags++;
                    this.createTrail(e.clientX, e.clientY);
                }
                
                this.updateStats();
            }

            updateStats() {
                this.stats.innerHTML = `
                    <div style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 5px;">
                        Clicks: ${this.interactions.clicks}<br>
                        Moves: ${this.interactions.moves}<br>
                        Drags: ${this.interactions.drags}
                    </div>
                `;
            }
        }

        // Initialize the visual effects
        const visualEffects = new VisualEffects();
    </script>
</body>
</html>